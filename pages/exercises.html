<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ejercicios Pr√°cticos - Amazon Linux CLI</title>
    <link rel="stylesheet" href="../styles.css">
</head>
<body>
    <header>
        <h1>üéØ Ejercicios Pr√°cticos y Desaf√≠os</h1>
        <p class="subtitle">Pon a prueba tus conocimientos de Amazon Linux CLI</p>
        <nav class="main-nav">
            <a href="../index.html">üè† Inicio</a>
            <a href="exercises.html">üéØ Ejercicios</a>
            <a href="simulator.html">üíª Simulador</a>
            <a href="filesystem.html">üìÅ Archivos</a>
            <a href="packages.html">üì¶ Paquetes</a>
        </nav>
    </header>
    <main>
        <section id="beginner">
            <h2>üü¢ Nivel Principiante</h2>
            
            <div class="category-card">
                <h3>Ejercicio 1: Exploraci√≥n del Sistema</h3>
                <p><strong>Objetivo:</strong> Familiarizarse con la navegaci√≥n y exploraci√≥n de archivos.</p>
                <div class="info-box">
                    <strong>Tareas:</strong>
                    <ol>
                        <li>Muestra tu directorio actual</li>
                        <li>Lista todos los archivos en /etc incluyendo ocultos</li>
                        <li>Encuentra el tama√±o del directorio /var/log</li>
                        <li>Cuenta cu√°ntos archivos .conf hay en /etc</li>
                        <li>Muestra las √∫ltimas 20 l√≠neas de /var/log/messages</li>
                    </ol>
                </div>
                <div class="success-box">
                    <strong>‚úÖ Soluci√≥n:</strong>
                    <pre><code># 1. Directorio actual
pwd

# 2. Listar todo en /etc
ls -la /etc

# 3. Tama√±o de /var/log
du -sh /var/log

# 4. Contar archivos .conf
find /etc -name "*.conf" -type f | wc -l

# 5. √öltimas 20 l√≠neas
sudo tail -20 /var/log/messages</code></pre>
                </div>
            </div>

            <div class="category-card">
                <h3>Ejercicio 2: Gesti√≥n B√°sica de Archivos</h3>
                <p><strong>Objetivo:</strong> Practicar creaci√≥n, copia y manipulaci√≥n de archivos.</p>
                <div class="info-box">
                    <strong>Tareas:</strong>
                    <ol>
                        <li>Crea un directorio llamado "practica" en tu home</li>
                        <li>Dentro de "practica", crea 5 archivos vac√≠os: file1.txt hasta file5.txt</li>
                        <li>Copia file1.txt a file1_backup.txt</li>
                        <li>Renombra file2.txt a renamed.txt</li>
                        <li>Elimina file3.txt y file4.txt</li>
                        <li>Comprime todo el directorio practica en practica.tar.gz</li>
                    </ol>
                </div>
                <div class="success-box">
                    <strong>‚úÖ Soluci√≥n:</strong>
                    <pre><code># 1. Crear directorio
mkdir ~/practica

# 2. Crear archivos
touch ~/practica/file{1..5}.txt

# 3. Copiar
cp ~/practica/file1.txt ~/practica/file1_backup.txt

# 4. Renombrar
mv ~/practica/file2.txt ~/practica/renamed.txt

# 5. Eliminar
rm ~/practica/file3.txt ~/practica/file4.txt

# 6. Comprimir
tar -czf practica.tar.gz ~/practica/</code></pre>
                </div>
            </div>
        </section>

        <section id="intermediate">
            <h2>üü° Nivel Intermedio</h2>
            
            <div class="category-card">
                <h3>Ejercicio 3: Instalaci√≥n y Gesti√≥n de Servicios</h3>
                <p><strong>Objetivo:</strong> Instalar y configurar un servidor web.</p>
                <div class="info-box">
                    <strong>Tareas:</strong>
                    <ol>
                        <li>Actualiza todos los paquetes del sistema</li>
                        <li>Instala nginx</li>
                        <li>Inicia el servicio nginx</li>
                        <li>Habilita nginx para que inicie autom√°ticamente al boot</li>
                        <li>Verifica que nginx est√° corriendo</li>
                        <li>Encuentra el proceso ID (PID) de nginx</li>
                        <li>Modifica el archivo de configuraci√≥n default en /etc/nginx/nginx.conf</li>
                        <li>Recarga la configuraci√≥n sin detener el servicio</li>
                    </ol>
                </div>
                <div class="success-box">
                    <strong>‚úÖ Soluci√≥n:</strong>
                    <pre><code># 1. Actualizar
sudo dnf update -y

# 2. Instalar nginx
sudo dnf install nginx -y

# 3. Iniciar
sudo systemctl start nginx

# 4. Habilitar
sudo systemctl enable nginx

# 5. Verificar
systemctl status nginx

# 6. Encontrar PID
pgrep nginx
# o
ps aux | grep nginx

# 7. Modificar config
sudo vi /etc/nginx/nginx.conf

# 8. Recargar
sudo systemctl reload nginx</code></pre>
                </div>
            </div>

            <div class="category-card">
                <h3>Ejercicio 4: An√°lisis de Logs</h3>
                <p><strong>Objetivo:</strong> Analizar logs del sistema para troubleshooting.</p>
                <div class="info-box">
                    <strong>Tareas:</strong>
                    <ol>
                        <li>Encuentra todos los errores en /var/log/messages de las √∫ltimas 24 horas</li>
                        <li>Cuenta cu√°ntos intentos fallidos de SSH ha habido</li>
                        <li>Lista las 10 IPs que m√°s han intentado conectarse por SSH</li>
                        <li>Encuentra cu√°ndo fue el √∫ltimo reinicio del sistema</li>
                        <li>Monitorea en tiempo real los logs de nginx</li>
                    </ol>
                </div>
                <div class="success-box">
                    <strong>‚úÖ Soluci√≥n:</strong>
                    <pre><code># 1. Errores √∫ltimas 24h
sudo journalctl --since "24 hours ago" -p err

# 2. Intentos SSH fallidos
sudo grep "Failed password" /var/log/secure | wc -l

# 3. Top 10 IPs
sudo grep "Failed password" /var/log/secure | awk '{print $(NF-3)}' | sort | uniq -c | sort -rn | head -10

# 4. √öltimo reinicio
last reboot | head -1

# 5. Monitorear nginx
sudo tail -f /var/log/nginx/access.log</code></pre>
                </div>
            </div>

            <div class="category-card">
                <h3>Ejercicio 5: Gesti√≥n de Usuarios y Permisos</h3>
                <p><strong>Objetivo:</strong> Crear usuarios y configurar permisos correctamente.</p>
                <div class="info-box">
                    <strong>Tareas:</strong>
                    <ol>
                        <li>Crea un usuario "developer" con home directory</li>
                        <li>Crea un grupo "webdev"</li>
                        <li>A√±ade "developer" al grupo "webdev"</li>
                        <li>Crea directorio /var/www/project</li>
                        <li>Cambia el propietario a developer:webdev</li>
                        <li>Establece permisos 775 en el directorio</li>
                        <li>Da permisos sudo al usuario developer</li>
                    </ol>
                </div>
                <div class="success-box">
                    <strong>‚úÖ Soluci√≥n:</strong>
                    <pre><code># 1. Crear usuario
sudo useradd -m developer

# 2. Crear grupo
sudo groupadd webdev

# 3. A√±adir a grupo
sudo usermod -aG webdev developer

# 4. Crear directorio
sudo mkdir -p /var/www/project

# 5. Cambiar propietario
sudo chown developer:webdev /var/www/project

# 6. Permisos
sudo chmod 775 /var/www/project

# 7. Dar sudo
sudo usermod -aG wheel developer</code></pre>
                </div>
            </div>
        </section>

        <section id="advanced">
            <h2>üî¥ Nivel Avanzado</h2>
            
            <div class="category-card">
                <h3>Ejercicio 6: Configuraci√≥n de Firewall y Seguridad</h3>
                <p><strong>Objetivo:</strong> Asegurar una instancia EC2.</p>
                <div class="info-box">
                    <strong>Tareas:</strong>
                    <ol>
                        <li>Verifica el estado de SELinux</li>
                        <li>Configura firewalld para permitir HTTP y HTTPS</li>
                        <li>Cierra todos los puertos excepto 22, 80 y 443</li>
                        <li>Cambia el puerto SSH default de 22 a 2222</li>
                        <li>Deshabilita autenticaci√≥n por password en SSH</li>
                        <li>Configura fail2ban para proteger SSH</li>
                    </ol>
                </div>
                <div class="success-box">
                    <strong>‚úÖ Soluci√≥n:</strong>
                    <pre><code># 1. Verificar SELinux
getenforce
sestatus

# 2. Configurar firewall
sudo firewall-cmd --add-service=http --permanent
sudo firewall-cmd --add-service=https --permanent
sudo firewall-cmd --reload

# 3. Configuraci√≥n restrictiva
sudo firewall-cmd --remove-service=dhcpv6-client --permanent
sudo firewall-cmd --list-all

# 4. Cambiar puerto SSH
sudo vi /etc/ssh/sshd_config
# Cambiar: Port 2222
sudo semanage port -a -t ssh_port_t -p tcp 2222
sudo firewall-cmd --add-port=2222/tcp --permanent
sudo systemctl restart sshd

# 5. Deshabilitar password auth
sudo vi /etc/ssh/sshd_config
# Cambiar: PasswordAuthentication no

# 6. Instalar fail2ban
sudo dnf install fail2ban -y
sudo systemctl enable --now fail2ban</code></pre>
                </div>
            </div>

            <div class="category-card">
                <h3>Ejercicio 7: Script de Backup Automatizado</h3>
                <p><strong>Objetivo:</strong> Crear un sistema de backup completo.</p>
                <div class="info-box">
                    <strong>Tareas:</strong>
                    <ol>
                        <li>Crea un script que haga backup de /var/www y /etc</li>
                        <li>El backup debe incluir fecha en el nombre</li>
                        <li>Debe comprimir los archivos</li>
                        <li>Eliminar backups de m√°s de 7 d√≠as</li>
                        <li>Enviar log del backup a un archivo</li>
                        <li>Programar ejecuci√≥n diaria a las 2 AM con cron</li>
                        <li>Subir backup a S3 (bonus)</li>
                    </ol>
                </div>
                <div class="success-box">
                    <strong>‚úÖ Soluci√≥n:</strong>
                    <pre><code>#!/bin/bash
# /usr/local/bin/backup.sh

set -e

BACKUP_DIR="/backup"
DATE=$(date +%Y%m%d_%H%M%S)
LOG_FILE="/var/log/backup.log"

mkdir -p "$BACKUP_DIR"

echo "$(date): Iniciando backup..." >> "$LOG_FILE"

# Backup de directorios
tar -czf "$BACKUP_DIR/www_$DATE.tar.gz" /var/www 2>> "$LOG_FILE"
tar -czf "$BACKUP_DIR/etc_$DATE.tar.gz" /etc 2>> "$LOG_FILE"

echo "$(date): Backup completado" >> "$LOG_FILE"

# Limpiar backups antiguos
find "$BACKUP_DIR" -name "*.tar.gz" -mtime +7 -delete

# Bonus: Subir a S3
# aws s3 sync "$BACKUP_DIR" s3://my-backup-bucket/

echo "$(date): Limpieza completada" >> "$LOG_FILE"

# Hacer ejecutable:
# sudo chmod +x /usr/local/bin/backup.sh

# A√±adir a crontab:
# crontab -e
# 0 2 * * * /usr/local/bin/backup.sh</code></pre>
                </div>
            </div>

            <div class="category-card">
                <h3>Ejercicio 8: Monitoreo y Performance Tuning</h3>
                <p><strong>Objetivo:</strong> Diagnosticar y optimizar rendimiento del sistema.</p>
                <div class="info-box">
                    <strong>Tareas:</strong>
                    <ol>
                        <li>Identifica los 5 procesos que m√°s CPU consumen</li>
                        <li>Identifica los 5 procesos que m√°s memoria consumen</li>
                        <li>Encuentra qu√© est√° llenando el disco</li>
                        <li>Monitorea I/O de disco en tiempo real</li>
                        <li>Verifica conexiones de red activas</li>
                        <li>Crea un script de monitoreo que alerte si CPU > 80%</li>
                    </ol>
                </div>
                <div class="success-box">
                    <strong>‚úÖ Soluci√≥n:</strong>
                    <pre><code># 1. Top CPU
ps aux --sort=-%cpu | head -6

# 2. Top Memoria
ps aux --sort=-%mem | head -6

# 3. Espacio en disco
du -sh /* | sort -rh | head -10

# 4. Monitor I/O
sudo iotop -o

# 5. Conexiones de red
ss -tunap | grep ESTAB

# 6. Script de monitoreo CPU
#!/bin/bash
# cpu_monitor.sh

CPU_THRESHOLD=80

while true; do
    CPU_USAGE=$(top -bn1 | grep "Cpu(s)" | awk '{print $2}' | cut -d'%' -f1)
    CPU_INT=${CPU_USAGE%.*}
    
    if [ $CPU_INT -gt $CPU_THRESHOLD ]; then
        echo "$(date): ALERTA - CPU en ${CPU_USAGE}%"
        # Enviar alerta
    fi
    
    sleep 60
done</code></pre>
                </div>
            </div>
        </section>

        <section id="aws-scenarios">
            <h2>‚òÅÔ∏è Escenarios AWS Reales</h2>
            
            <div class="category-card">
                <h3>Escenario 1: Nueva Instancia EC2</h3>
                <p><strong>Situaci√≥n:</strong> Acabas de lanzar una nueva instancia EC2 y necesitas configurarla como servidor web.</p>
                <div class="warning-box">
                    <strong>Completa estas tareas:</strong>
                    <ol>
                        <li>Actualiza el sistema completamente</li>
                        <li>Configura hostname a "webserver-prod"</li>
                        <li>Instala y configura nginx</li>
                        <li>Crea usuario "deployer" sin password (solo SSH key)</li>
                        <li>Configura firewall para web</li>
                        <li>Instala CloudWatch agent para monitoreo</li>
                        <li>Configura backups autom√°ticos a S3</li>
                        <li>Habilita actualizaciones de seguridad autom√°ticas</li>
                    </ol>
                </div>
            </div>

            <div class="category-card">
                <h3>Escenario 2: Volumen EBS Lleno</h3>
                <p><strong>Situaci√≥n:</strong> Tu volumen EBS est√° al 95% de capacidad y la aplicaci√≥n est√° fallando.</p>
                <div class="danger-box">
                    <strong>Tareas urgentes:</strong>
                    <ol>
                        <li>Identifica qu√© est√° consumiendo espacio</li>
                        <li>Limpia logs antiguos</li>
                        <li>Comprime archivos grandes</li>
                        <li>A√±ade un nuevo volumen EBS de 50GB</li>
                        <li>Monta el nuevo volumen en /data</li>
                        <li>Mueve archivos grandes al nuevo volumen</li>
                        <li>Configura montaje autom√°tico en /etc/fstab</li>
                    </ol>
                </div>
            </div>

            <div class="category-card">
                <h3>Escenario 3: Instancia Comprometida</h3>
                <p><strong>Situaci√≥n:</strong> Detectaste actividad sospechosa. Necesitas investigar.</p>
                <div class="danger-box">
                    <strong>Investigaci√≥n forense:</strong>
                    <ol>
                        <li>Revisa conexiones de red activas</li>
                        <li>Identifica procesos sospechosos</li>
                        <li>Revisa logs de autenticaci√≥n SSH</li>
                        <li>Busca archivos modificados recientemente</li>
                        <li>Verifica crontabs de todos los usuarios</li>
                        <li>Revisa usuarios y grupos del sistema</li>
                        <li>Toma snapshot del volumen antes de cualquier cambio</li>
                        <li>A√≠sla la instancia del tr√°fico de red</li>
                    </ol>
                </div>
            </div>
        </section>

        <section id="challenges">
            <h2>üèÜ Desaf√≠os Finales</h2>
            
            <div class="category-card special">
                <h3>Desaf√≠o Maestro: Stack LAMP Completo</h3>
                <p><strong>Crea desde cero un stack LAMP seguro y optimizado:</strong></p>
                <ol>
                    <li>Instala Apache, MariaDB, PHP</li>
                    <li>Configura virtual hosts</li>
                    <li>Asegura MariaDB (mysql_secure_installation)</li>
                    <li>Configura SSL con certificado autofirmado</li>
                    <li>Implementa firewall restrictivo</li>
                    <li>Configura SELinux correctamente</li>
                    <li>Crea scripts de backup automatizados</li>
                    <li>Implementa monitoreo con CloudWatch</li>
                    <li>Configura logrotate para logs de aplicaci√≥n</li>
                    <li>Documenta todo el proceso</li>
                </ol>
            </div>

            <div class="category-card special">
                <h3>Desaf√≠o Automatizaci√≥n: Infrastructure as Code</h3>
                <p><strong>Crea un script que automatice completamente:</strong></p>
                <ol>
                    <li>Detecci√≥n del tipo de instancia EC2</li>
                    <li>Instalaci√≥n de software seg√∫n el tipo</li>
                    <li>Configuraci√≥n de usuarios y permisos</li>
                    <li>Setup de firewall y SELinux</li>
                    <li>Configuraci√≥n de backups a S3</li>
                    <li>Instalaci√≥n de agentes de monitoreo</li>
                    <li>Hardening de seguridad</li>
                    <li>Validaci√≥n post-instalaci√≥n</li>
                    <li>Generaci√≥n de reporte de configuraci√≥n</li>
                </ol>
            </div>
        </section>

        <section id="tips">
            <h2>üí° Consejos para Practicar</h2>
            <div class="success-box">
                <ul>
                    <li>‚úÖ Practica en una instancia EC2 de desarrollo, nunca en producci√≥n</li>
                    <li>‚úÖ Toma snapshots antes de cambios importantes</li>
                    <li>‚úÖ Documenta cada paso que realices</li>
                    <li>‚úÖ Usa el simulador para practicar sin riesgos</li>
                    <li>‚úÖ Lee los mensajes de error completamente</li>
                    <li>‚úÖ Consulta man pages: <code>man comando</code></li>
                    <li>‚úÖ Usa <code>--help</code> para ver opciones: <code>comando --help</code></li>
                    <li>‚úÖ Practica escribiendo scripts bash</li>
                    <li>‚úÖ Aprende de tus errores - son la mejor forma de aprender</li>
                </ul>
            </div>
        </section>
    </main>
    <footer>
        <p>üí™ ¬°Practica, practica y dominar√°s Amazon Linux CLI!</p>
    </footer>
</body>
</html>
